"""src/handlers/main_menu.py
–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π.
"""
from __future__ import annotations

import asyncio
from aiogram import Router, types
from aiogram.filters import CommandStart
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton, InlineKeyboardMarkup, InlineKeyboardButton

router = Router()

# –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
main_menu_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="üöÄ –°—Ç–∞—Ä—Ç")],
        [KeyboardButton(text="üîÆ –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä")],
        [KeyboardButton(text="üß† –†–∞–∑–±–æ—Ä —á–∏—Å–ª–∞ —Å–æ–∑–Ω–∞–Ω–∏—è"), KeyboardButton(text="‚ö° –†–∞–∑–±–æ—Ä —á–∏—Å–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è")],
        [KeyboardButton(text="üìù –†–∞–∑–±–æ—Ä —á–∏—Å–ª–∞ –∏–º–µ–Ω–∏"), KeyboardButton(text="üìä –†–∞–∑–±–æ—Ä –º–∞—Ç—Ä–∏—Ü—ã")],
        [KeyboardButton(text="‚ú® –ü—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É")],
        [KeyboardButton(text="‚ùì –ü–æ–º–æ—â—å")]
    ],
    resize_keyboard=True,
    one_time_keyboard=False
)

# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
WELCOME_MESSAGE = """üåü **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –¶–∏—Ñ—Ä–æ–≤–æ–≥–æ –ü—Å–∏—Ö–æ–ª–æ–≥–∞!**

–Ø –ø–æ–º–æ–≥—É –≤–∞–º —Ä–∞—Å–∫—Ä—ã—Ç—å —Ç–∞–π–Ω—ã –≤–∞—à–µ–π –ª–∏—á–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏ –ú–∏–ª–∞–Ω—ã –¢–∞—Ä–±–∞.

**üîÆ –ß—Ç–æ —è —É–º–µ—é:**
‚Ä¢ **–ü–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä** - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
‚Ä¢ **–ß–∏—Å–ª–æ —Å–æ–∑–Ω–∞–Ω–∏—è** - —á–µ–≥–æ —Ö–æ—á–µ—Ç –≤–∞—à–∞ –¥—É—à–∞
‚Ä¢ **–ß–∏—Å–ª–æ –¥–µ–π—Å—Ç–≤–∏—è** - –∫–∞–∫ –≤—ã –¥–µ–π—Å—Ç–≤—É–µ—Ç–µ –ø–æ—Å–ª–µ 33 –ª–µ—Ç
‚Ä¢ **–ß–∏—Å–ª–æ –∏–º–µ–Ω–∏** - —ç–Ω–µ—Ä–≥–∏—è –≤–∞—à–µ–≥–æ –∏–º–µ–Ω–∏
‚Ä¢ **–ú–∞—Ç—Ä–∏—Ü–∞** - –∫–∞–∫–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –≤ –≤–∞—Å –∑–∞–ª–æ–∂–µ–Ω—ã
‚Ä¢ **–ü—Ä–∞–∫—Ç–∏–∫–∏** - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ üëá"""

# –û–ø–∏—Å–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã
ANALYSIS_DESCRIPTIONS = {
    "full": """üîÆ **–ü–û–õ–ù–´–ô –†–ê–ó–ë–û–†**

**–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:**
‚Ä¢ –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π (–ß–°, –ß–î, –ú–∞—Ç—Ä–∏—Ü–∞, –ß–∏—Å–ª–æ –ò–º–µ–Ω–∏)
‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é
‚Ä¢ –ê–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —ç–Ω–µ—Ä–≥–∏–π
‚Ä¢ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:** 2-3 –º–∏–Ω—É—Ç—ã
**–¢–æ—á–Ω–æ—Å—Ç—å:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è (–≤—Å–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã)""",

    "consciousness": """üß† **–†–ê–ó–ë–û–† –ß–ò–°–õ–ê –°–û–ó–ù–ê–ù–ò–Ø**

**–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:**
‚Ä¢ –ß–µ–≥–æ —Ö–æ—á–µ—Ç –≤–∞—à–∞ –¥—É—à–∞ (—Ç–æ–ª—å–∫–æ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è)
‚Ä¢ –í–∞—à–∏ –∏—Å—Ç–∏–Ω–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è –∏ —Å—Ç—Ä–µ–º–ª–µ–Ω–∏—è
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥—É—Ö–æ–≤–Ω–æ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é
‚Ä¢ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏

**–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:** 1-2 –º–∏–Ω—É—Ç—ã
**–û—Å–Ω–æ–≤–∞:** –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è""",

    "action": """‚ö° **–†–ê–ó–ë–û–† –ß–ò–°–õ–ê –î–ï–ô–°–¢–í–ò–Ø**

**–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:**
‚Ä¢ –ö–∞–∫ –≤—ã –¥–µ–π—Å—Ç–≤—É–µ—Ç–µ –ø–æ—Å–ª–µ 33 –ª–µ—Ç (–≤—Å—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)
‚Ä¢ –í–∞—à —Å—Ç–∏–ª—å –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–∞—Ä—å–µ—Ä–Ω–æ–º—É —Ä–æ—Å—Ç—É
‚Ä¢ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤–∞—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

**–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:** 1-2 –º–∏–Ω—É—Ç—ã
**–û—Å–Ω–æ–≤–∞:** –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è""",

    "name": """üìù **–†–ê–ó–ë–û–† –ß–ò–°–õ–ê –ò–ú–ï–ù–ò**

**–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:**
‚Ä¢ –≠–Ω–µ—Ä–≥–∏—é –≤–∞—à–µ–≥–æ –∏–º–µ–Ω–∏
‚Ä¢ –ö–∞–∫ –∏–º—è –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–∞—à—É —Å—É–¥—å–±—É
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏–º–µ–Ω–∏
‚Ä¢ –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∏ –∏–º–µ–Ω–∏

**–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:** 1-2 –º–∏–Ω—É—Ç—ã
**–û—Å–Ω–æ–≤–∞:** –í–∞—à–µ –∏–º—è""",

    "matrix": """üìä **–†–ê–ó–ë–û–† –ú–ê–¢–†–ò–¶–´**

**–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:**
‚Ä¢ –ö–∞–∫–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –≤ –≤–∞—Å –∑–∞–ª–æ–∂–µ–Ω—ã (–≤—Å—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)
‚Ä¢ –°–∏–ª—å–Ω—ã–µ –∏ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
‚Ä¢ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ

**–í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞:** 1-2 –º–∏–Ω—É—Ç—ã
**–û—Å–Ω–æ–≤–∞:** –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è""",

    "practices": """‚ú® **–ü–†–ê–ö–¢–ò–ö–ê –ü–û –ó–ê–ü–†–û–°–£**

**–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:**
‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É
‚Ä¢ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –Ω—É–∂–Ω—ã—Ö –∫–∞—á–µ—Å—Ç–≤
‚Ä¢ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
‚Ä¢ –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

**–í—Ä–µ–º—è –ø–æ–∏—Å–∫–∞:** 30 —Å–µ–∫—É–Ω–¥
**–û—Å–Ω–æ–≤–∞:** –í–∞—à –∑–∞–ø—Ä–æ—Å"""
}


@router.message(CommandStart())
async def on_start(message: types.Message) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é."""
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É
    try:
        import os
        photo_path = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), "..", "media", "kartinka.jpg")
        await message.answer_photo(
            photo=open(photo_path, 'rb'),
            caption=WELCOME_MESSAGE,
            parse_mode="Markdown",
            reply_markup=main_menu_keyboard
        )
    except Exception as e:
        # –ï—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É: {e}")
        await message.answer(
            WELCOME_MESSAGE,
            parse_mode="Markdown",
            reply_markup=main_menu_keyboard
        )


@router.message(lambda message: message.text == "üîÆ –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä")
async def full_analysis_start(message: types.Message) -> None:
    """–ù–∞—á–∞–ª–æ –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞."""
    from .step_handler import user_data
    
    user_id = message.from_user.id
    user_data[user_id] = {'state': 'full_analysis_query'}
    
    await message.answer(
        ANALYSIS_DESCRIPTIONS["full"],
        parse_mode="Markdown"
    )
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await message.answer(
        "**üìù –®–∞–≥ 1 –∏–∑ 3: –í–∞—à –∑–∞–ø—Ä–æ—Å**\n\n"
        "–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –∏–ª–∏ –±–µ—Å–ø–æ–∫–æ–∏—Ç:\n"
        "‚Ä¢ –ö–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã —É –≤–∞—Å –µ—Å—Ç—å?\n"
        "‚Ä¢ –ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –æ —Å–µ–±–µ?\n"
        "‚Ä¢ –ö–∞–∫–∏–µ —Å—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏ –≤–∞—Å –≤–æ–ª–Ω—É—é—Ç?\n\n"
        "*–ù–∞–ø—Ä–∏–º–µ—Ä: \"–•–æ—á—É –ø–æ–Ω—è—Ç—å —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏ –∫–∞–∫ –ª—É—á—à–µ —Å—Ç—Ä–æ–∏—Ç—å –∫–∞—Ä—å–µ—Ä—É\"*",
        parse_mode="Markdown"
    )


@router.message(lambda message: message.text == "üß† –†–∞–∑–±–æ—Ä —á–∏—Å–ª–∞ —Å–æ–∑–Ω–∞–Ω–∏—è")
async def consciousness_analysis_start(message: types.Message) -> None:
    """–ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞ —á–∏—Å–ª–∞ —Å–æ–∑–Ω–∞–Ω–∏—è."""
    from .step_handler import user_data
    
    user_id = message.from_user.id
    user_data[user_id] = {'state': 'consciousness_query'}
    
    await message.answer(
        ANALYSIS_DESCRIPTIONS["consciousness"],
        parse_mode="Markdown"
    )
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await message.answer(
        "**üìù –®–∞–≥ 1 –∏–∑ 2: –í–∞—à –∑–∞–ø—Ä–æ—Å**\n\n"
        "–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤ –ø–ª–∞–Ω–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∂–µ–ª–∞–Ω–∏–π:\n"
        "‚Ä¢ –ß–µ–≥–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç –∂–∏–∑–Ω–∏?\n"
        "‚Ä¢ –ö–∞–∫–∏–µ —É –≤–∞—Å –µ—Å—Ç—å –º–µ—á—Ç—ã?\n"
        "‚Ä¢ –ß—Ç–æ –≤–∞—Å –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç?\n\n"
        "*–ù–∞–ø—Ä–∏–º–µ—Ä: \"–•–æ—á—É –ø–æ–Ω—è—Ç—å, —á–µ–≥–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ö–æ—á–µ—Ç –º–æ—è –¥—É—à–∞\"*",
        parse_mode="Markdown"
    )


@router.message(lambda message: message.text == "‚ö° –†–∞–∑–±–æ—Ä —á–∏—Å–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è")
async def action_analysis_start(message: types.Message) -> None:
    """–ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞ —á–∏—Å–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è."""
    from .step_handler import user_data
    
    user_id = message.from_user.id
    user_data[user_id] = {'state': 'action_query'}
    
    await message.answer(
        ANALYSIS_DESCRIPTIONS["action"],
        parse_mode="Markdown"
    )
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await message.answer(
        "**üìù –®–∞–≥ 1 –∏–∑ 2: –í–∞—à –∑–∞–ø—Ä–æ—Å**\n\n"
        "–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤ –ø–ª–∞–Ω–µ –¥–µ–π—Å—Ç–≤–∏–π:\n"
        "‚Ä¢ –ö–∞–∫ –≤—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ —Ä–µ—à–µ–Ω–∏—è?\n"
        "‚Ä¢ –ö–∞–∫–∏–µ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏?\n"
        "‚Ä¢ –ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏?\n\n"
        "*–ù–∞–ø—Ä–∏–º–µ—Ä: \"–•–æ—á—É –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É —è –Ω–µ –º–æ–≥—É –ø—Ä–∏–Ω–∏–º–∞—Ç—å –±—ã—Å—Ç—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è\"*",
        parse_mode="Markdown"
    )


@router.message(lambda message: message.text == "üìù –†–∞–∑–±–æ—Ä —á–∏—Å–ª–∞ –∏–º–µ–Ω–∏")
async def name_analysis_start(message: types.Message) -> None:
    """–ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞ —á–∏—Å–ª–∞ –∏–º–µ–Ω–∏."""
    from .step_handler import user_data
    
    user_id = message.from_user.id
    user_data[user_id] = {'state': 'name_query'}
    
    await message.answer(
        ANALYSIS_DESCRIPTIONS["name"],
        parse_mode="Markdown"
    )
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await message.answer(
        "**üìù –®–∞–≥ 1 –∏–∑ 2: –í–∞—à –∑–∞–ø—Ä–æ—Å**\n\n"
        "–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤ –ø–ª–∞–Ω–µ –∏–º–µ–Ω–∏:\n"
        "‚Ä¢ –ö–∞–∫ –∏–º—è –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–∞—à—É –∂–∏–∑–Ω—å?\n"
        "‚Ä¢ –°—Ç–æ–∏—Ç –ª–∏ –º–µ–Ω—è—Ç—å –∏–º—è?\n"
        "‚Ä¢ –ö–∞–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è –≤ –≤–∞—à–µ–º –∏–º–µ–Ω–∏?\n\n"
        "*–ù–∞–ø—Ä–∏–º–µ—Ä: \"–•–æ—á—É –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –º–æ–µ –∏–º—è –≤–ª–∏—è–µ—Ç –Ω–∞ –º–æ—é —Å—É–¥—å–±—É\"*",
        parse_mode="Markdown"
    )


@router.message(lambda message: message.text == "üìä –†–∞–∑–±–æ—Ä –º–∞—Ç—Ä–∏—Ü—ã")
async def matrix_analysis_start(message: types.Message) -> None:
    """–ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞ –º–∞—Ç—Ä–∏—Ü—ã."""
    from .step_handler import user_data
    
    user_id = message.from_user.id
    user_data[user_id] = {'state': 'matrix_query'}
    
    await message.answer(
        ANALYSIS_DESCRIPTIONS["matrix"],
        parse_mode="Markdown"
    )
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await message.answer(
        "**üìù –®–∞–≥ 1 –∏–∑ 2: –í–∞—à –∑–∞–ø—Ä–æ—Å**\n\n"
        "–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤ –ø–ª–∞–Ω–µ —ç–Ω–µ—Ä–≥–∏–π:\n"
        "‚Ä¢ –ö–∞–∫–∏–µ —É –≤–∞—Å —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã?\n"
        "‚Ä¢ –ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å?\n"
        "‚Ä¢ –ö–∞–∫–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç?\n\n"
        "*–ù–∞–ø—Ä–∏–º–µ—Ä: \"–•–æ—á—É –ø–æ–Ω—è—Ç—å —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ –∏ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã\"*",
        parse_mode="Markdown"
    )


@router.message(lambda message: message.text == "‚ú® –ü—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É")
async def practices_start(message: types.Message) -> None:
    """–ù–∞—á–∞–ª–æ –ø–æ–∏—Å–∫–∞ –ø—Ä–∞–∫—Ç–∏–∫."""
    from .step_handler import user_data
    
    user_id = message.from_user.id
    user_data[user_id] = {'state': 'practices_query'}
    
    await message.answer(
        ANALYSIS_DESCRIPTIONS["practices"],
        parse_mode="Markdown"
    )
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await message.answer(
        "**üìù –í–∞—à –∑–∞–ø—Ä–æ—Å**\n\n"
        "–û–ø–∏—à–∏—Ç–µ, –∫–∞–∫–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∞–º –Ω—É–∂–Ω—ã:\n"
        "‚Ä¢ –ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–≤–∏—Ç—å –≤ —Å–µ–±–µ?\n"
        "‚Ä¢ –ö–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–∏—Ç—å?\n"
        "‚Ä¢ –ö–∞–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —É–ª—É—á—à–∏—Ç—å?\n\n"
        "*–ù–∞–ø—Ä–∏–º–µ—Ä: \"–•–æ—á—É —Å—Ç–∞—Ç—å –±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–Ω—ã–º –≤ —Å–µ–±–µ\" –∏–ª–∏ \"–ù—É–∂–Ω—ã –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –ª–∏–¥–µ—Ä—Å—Ç–≤–∞\"*",
        parse_mode="Markdown"
    )


@router.message(lambda message: message.text == "üöÄ –°—Ç–∞—Ä—Ç")
async def start_button_handler(message: types.Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –°—Ç–∞—Ä—Ç."""
    await on_start(message)

@router.message(lambda message: message.text == "‚ùì –ü–æ–º–æ—â—å")
async def show_help(message: types.Message) -> None:
    """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É."""
    help_text = """üìñ **–°–ü–†–ê–í–ö–ê –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ –ë–û–¢–ê**

**üìÖ –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è:**
‚Ä¢ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: `dd.mm.yyyy`
‚Ä¢ –ü—Ä–∏–º–µ—Ä—ã: `15.03.1990`, `01.01.2000`

**üë§ –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏:**
‚Ä¢ –ú–æ–∂–Ω–æ –Ω–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü–µ: *–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤*
‚Ä¢ –ú–æ–∂–Ω–æ –Ω–∞ –ª–∞—Ç–∏–Ω–∏—Ü–µ: *Ivan Petrov*
‚Ä¢ –ü–æ–ª–Ω–æ–µ –∏–º—è (–∏–º—è + —Ñ–∞–º–∏–ª–∏—è)

**üîÆ –ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —á–∏—Å–ª–∞:**
‚Ä¢ **–ß–°** - —á–µ–≥–æ —Ö–æ—á–µ—Ç –≤–∞—à–∞ –¥—É—à–∞ (—Ç–æ–ª—å–∫–æ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è)
‚Ä¢ **–ß–î** - –∫–∞–∫ –≤—ã –¥–µ–π—Å—Ç–≤—É–µ—Ç–µ –ø–æ—Å–ª–µ 33 –ª–µ—Ç (–≤—Å—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)
‚Ä¢ **–ß–∏—Å–ª–æ –ò–º–µ–Ω–∏** - —ç–Ω–µ—Ä–≥–∏—è –≤–∞—à–µ–≥–æ –∏–º–µ–Ω–∏ (—Ç–æ–ª—å–∫–æ –∏–º—è)
‚Ä¢ **–ú–∞—Ç—Ä–∏—Ü–∞** - –∫–∞–∫–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –≤ –≤–∞—Å –∑–∞–ª–æ–∂–µ–Ω—ã (–≤—Å—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)

**–°–∏–ª–∞ —ç–Ω–µ—Ä–≥–∏–π –≤ –º–∞—Ç—Ä–∏—Ü–µ:**
‚Ä¢ 1 —Ü–∏—Ñ—Ä–∞ = 50% –∫–∞—á–µ—Å—Ç–≤–∞
‚Ä¢ 2 —Ü–∏—Ñ—Ä—ã = 100% –∫–∞—á–µ—Å—Ç–≤–∞
‚Ä¢ 3+ —Ü–∏—Ñ—Ä = —É—Å–∏–ª–µ–Ω–∏–µ –Ω–∞ —Å–ø–∞–¥

*–í—Å–µ —Ä–∞—Å—á—ë—Ç—ã –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ ¬´–ö–Ω–∏–≥–µ –ó–Ω–∞–Ω–∏–π –ø–æ –¶–∏—Ñ—Ä–æ–ª–æ–≥–∏–∏¬ª —Å–∏—Å—Ç–µ–º—ã –ú–∏–ª–∞–Ω—ã –¢–∞—Ä–±–∞.*"""
    
    await message.answer(help_text, parse_mode="Markdown")
